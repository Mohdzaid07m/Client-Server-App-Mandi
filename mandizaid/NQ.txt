SELECT STOCKE.SNAME,
STOCKE.INAME,STOCKE.TRUCK_NO,STOCKE.
CATEG,AVG(NVL(STOCKE.NAG,0))-SUM(NVL(BUYER_DETAIL1.NAG,0)) NAG ,STOCKE.SENDER_NO,STOCKE.ITEM_CODE 
FROM STOCKE,BUYER_DETAIL1 WHERE STOCKE.TRUCK_NO=BUYER_DETAIL1.TRUCK_NO
AND STOCKE.CATEG=BUYER_DETAIL1.CATEG AND STOCKE.SENDER_NO=BUYER_DETAIL1.SENDER_NO AND 
STOCKE.ITEM_CODE=BUYER_DETAIL1.ITEM_CODE GROUP BY STOCKE.SENDER_NO,STOCKE.SNAME,
STOCKE.ITEM_CODE,STOCKE.INAME,STOCKE.TRUCK_NO,STOCKE.CATEG
/
